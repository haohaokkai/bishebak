{"remainingRequest":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\babel-loader\\lib\\index.js!F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\schedule\\add-or-update.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\schedule\\add-or-update.vue","mtime":1743106284972},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBwYXJlbnQ6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkOiAiIiwKICAgICAgdHlwZTogIiIsCiAgICAgIHJ1bGVGb3JtOiB7CiAgICAgICAgZG9jdG9ySWQ6ICIiLAogICAgICAgIC8vIOS7jueZu+W9leS/oeaBr+S4reiOt+WPlgogICAgICAgIHdvcmtEYXRlOiAiIiwKICAgICAgICB0aW1lU2xvdDogIiIsCiAgICAgICAgbWF4UGF0aWVudHM6IDUsCiAgICAgICAgYm9va2VkQ291bnQ6IDAKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICB3b3JrRGF0ZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+mAieaLqeaXpeacnyIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XSwKICAgICAgICB0aW1lU2xvdDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+mAieaLqeaXtumXtOautSIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XSwKICAgICAgICBtYXhQYXRpZW50czogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+i+k+WFpeacgOWkp+mihOe6puS6uuaVsCIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XQogICAgICB9LAogICAgICBhZGRFZGl0Rm9ybTogewogICAgICAgIGFkZEVkaXRCb3hDb2xvcjogIiNmZmYiCiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgLy8g5Yid5aeL5YyWCiAgICBpbml0KGlkLCB0eXBlKSB7CiAgICAgIHRoaXMuaWQgPSBpZDsKICAgICAgdGhpcy50eXBlID0gdHlwZTsKCiAgICAgIC8vIOiuvue9ruW9k+WJjeWMu+eUn0lECiAgICAgIHRoaXMucnVsZUZvcm0uZG9jdG9ySWQgPSB0aGlzLiRzdG9yYWdlLmdldCgidXNlcmlkIik7CiAgICAgIGlmIChpZCkgewogICAgICAgIHRoaXMuJGh0dHAoewogICAgICAgICAgdXJsOiBgc2NoZWR1bGUvaW5mby8ke2lkfWAsCiAgICAgICAgICBtZXRob2Q6ICJnZXQiLAogICAgICAgICAgcGFyYW1zOiB7fQogICAgICAgIH0pLnRoZW4oKHsKICAgICAgICAgIGRhdGEKICAgICAgICB9KSA9PiB7CiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmNvZGUgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5ydWxlRm9ybSA9IGRhdGEuZGF0YTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIOagvOW8j+WMluaXtumXtOauteS4unh4Onh4LXh4Onh45qC85byPCiAgICBmb3JtYXRUaW1lU2xvdCgpIHsKICAgICAgaWYgKHRoaXMucnVsZUZvcm0udGltZVNsb3QpIHsKICAgICAgICBjb25zdCBzdGFydFRpbWUgPSB0aGlzLnJ1bGVGb3JtLnRpbWVTbG90OwogICAgICAgIC8vIOS7jjA4OjAw5b2i5byP5o+Q5Y+W5bCP5pe25ZKM5YiG6ZKf77yM6L2s5Li65pWw5a2XCiAgICAgICAgY29uc3QgW3N0YXJ0SG91ciwgc3RhcnRNaW51dGVdID0gc3RhcnRUaW1lLnNwbGl0KCc6JykubWFwKE51bWJlcik7CgogICAgICAgIC8vIOiuoeeul+e7k+adn+aXtumXtO+8iOWBh+iuvuavj+S4quaXtumXtOauteS4ujHlsI/ml7bvvIkKICAgICAgICBsZXQgZW5kSG91ciA9IHN0YXJ0SG91ciArIDE7CiAgICAgICAgbGV0IGVuZE1pbnV0ZSA9IHN0YXJ0TWludXRlOwoKICAgICAgICAvLyDmoLzlvI/ljJbnu5PmnZ/ml7bpl7QKICAgICAgICBjb25zdCBlbmRUaW1lID0gYCR7ZW5kSG91ci50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7ZW5kTWludXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gOwoKICAgICAgICAvLyDorr7nva7moLzlvI/ljJblkI7nmoTml7bpl7TmrrUKICAgICAgICB0aGlzLnJ1bGVGb3JtLnRpbWVTbG90ID0gYCR7c3RhcnRUaW1lfS0ke2VuZFRpbWV9YDsKICAgICAgfQogICAgfSwKICAgIC8vIOaPkOS6pAogICAgb25TdWJtaXQoKSB7CiAgICAgIHRoaXMuJHJlZnNbInJ1bGVGb3JtIl0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdGhpcy4kaHR0cCh7CiAgICAgICAgICAgIHVybDogYHNjaGVkdWxlLyR7IXRoaXMucnVsZUZvcm0uaWQgPyAic2F2ZSIgOiAidXBkYXRlIn1gLAogICAgICAgICAgICBtZXRob2Q6ICJwb3N0IiwKICAgICAgICAgICAgZGF0YTogdGhpcy5ydWxlRm9ybQogICAgICAgICAgfSkudGhlbigoewogICAgICAgICAgICBkYXRhCiAgICAgICAgICB9KSA9PiB7CiAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuY29kZSA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogIuaTjeS9nOaIkOWKnyIsCiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncmVmcmVzaERhdGFMaXN0Jyk7CiAgICAgICAgICAgICAgICAgIHRoaXMuYmFjaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZGF0YS5tc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOi/lOWbngogICAgYmFjaygpIHsKICAgICAgaWYgKHRoaXMucGFyZW50KSB7CiAgICAgICAgdGhpcy5wYXJlbnQuc2hvd0ZsYWcgPSB0cnVlOwogICAgICAgIHRoaXMucGFyZW50LmFkZE9yVXBkYXRlRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["props","parent","type","Object","required","data","id","ruleForm","doctorId","workDate","timeSlot","maxPatients","bookedCount","rules","message","trigger","addEditForm","addEditBoxColor","mounted","methods","init","$storage","get","$http","url","method","params","then","code","formatTimeSlot","startTime","startHour","startMinute","split","map","Number","endHour","endMinute","endTime","toString","padStart","onSubmit","$refs","validate","valid","$message","duration","onClose","$emit","back","error","msg","showFlag","addOrUpdateFlag"],"sources":["src/views/modules/schedule/add-or-update.vue"],"sourcesContent":["<template>\r\n  <div class=\"addEdit-block\">\r\n    <el-form\r\n      class=\"detail-form-content\"\r\n      ref=\"ruleForm\"\r\n      :model=\"ruleForm\"\r\n      :rules=\"rules\"\r\n      label-width=\"120px\"\r\n      :style=\"{backgroundColor:addEditForm.addEditBoxColor}\"\r\n    >\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item class=\"date\" label=\"日期\" prop=\"workDate\">\r\n            <el-date-picker\r\n              v-model=\"ruleForm.workDate\"\r\n              type=\"date\"\r\n              value-format=\"yyyy-MM-dd\"\r\n              placeholder=\"选择日期\">\r\n            </el-date-picker>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item class=\"time\" label=\"时间段\" prop=\"timeSlot\">\r\n            <el-time-select\r\n              v-model=\"ruleForm.timeSlot\"\r\n              :picker-options=\"{\r\n                start: '08:00',\r\n                step: '01:00',\r\n                end: '18:00'\r\n              }\"\r\n              placeholder=\"选择时间段\"\r\n              @change=\"formatTimeSlot\">\r\n            </el-time-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item class=\"input\" label=\"最大预约人数\" prop=\"maxPatients\">\r\n            <el-input-number v-model=\"ruleForm.maxPatients\" :min=\"1\" :max=\"20\"></el-input-number>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-form-item class=\"btn\">\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"onSubmit\"\r\n        >提交</el-button>\r\n        <el-button @click=\"back()\">返回</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    parent: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      id: \"\",\r\n      type: \"\",\r\n      ruleForm: {\r\n        doctorId: \"\", // 从登录信息中获取\r\n        workDate: \"\",\r\n        timeSlot: \"\",\r\n        maxPatients: 5,\r\n        bookedCount: 0,\r\n      },\r\n      rules: {\r\n        workDate: [{ required: true, message: \"请选择日期\", trigger: \"blur\" }],\r\n        timeSlot: [{ required: true, message: \"请选择时间段\", trigger: \"blur\" }],\r\n        maxPatients: [{ required: true, message: \"请输入最大预约人数\", trigger: \"blur\" }]\r\n      },\r\n      addEditForm: {\r\n        addEditBoxColor: \"#fff\"\r\n      }\r\n    };\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    // 初始化\r\n    init(id, type) {\r\n      this.id = id;\r\n      this.type = type;\r\n      \r\n      // 设置当前医生ID\r\n      this.ruleForm.doctorId = this.$storage.get(\"userid\");\r\n      \r\n      if (id) {\r\n        this.$http({\r\n          url: `schedule/info/${id}`,\r\n          method: \"get\",\r\n          params: {}\r\n        }).then(({ data }) => {\r\n          if (data && data.code === 0) {\r\n            this.ruleForm = data.data;\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // 格式化时间段为xx:xx-xx:xx格式\r\n    formatTimeSlot() {\r\n      if (this.ruleForm.timeSlot) {\r\n        const startTime = this.ruleForm.timeSlot;\r\n        // 从08:00形式提取小时和分钟，转为数字\r\n        const [startHour, startMinute] = startTime.split(':').map(Number);\r\n        \r\n        // 计算结束时间（假设每个时间段为1小时）\r\n        let endHour = startHour + 1;\r\n        let endMinute = startMinute;\r\n        \r\n        // 格式化结束时间\r\n        const endTime = `${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;\r\n        \r\n        // 设置格式化后的时间段\r\n        this.ruleForm.timeSlot = `${startTime}-${endTime}`;\r\n      }\r\n    },\r\n    // 提交\r\n    onSubmit() {\r\n      this.$refs[\"ruleForm\"].validate(valid => {\r\n        if (valid) {\r\n          this.$http({\r\n            url: `schedule/${!this.ruleForm.id ? \"save\" : \"update\"}`,\r\n            method: \"post\",\r\n            data: this.ruleForm\r\n          }).then(({ data }) => {\r\n            if (data && data.code === 0) {\r\n              this.$message({\r\n                message: \"操作成功\",\r\n                type: \"success\",\r\n                duration: 1500,\r\n                onClose: () => {\r\n                  this.$emit('refreshDataList');\r\n                  this.back();\r\n                }\r\n              });\r\n            } else {\r\n              this.$message.error(data.msg);\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    // 返回\r\n    back() {\r\n      if (this.parent) {\r\n        this.parent.showFlag = true;\r\n        this.parent.addOrUpdateFlag = false;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.editor{\r\n  height: 500px;\r\n}\r\n</style> "],"mappings":"AAqDA;EACAA,KAAA;IACAC,MAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,QAAA;IACA;EACA;EACAC,KAAA;IACA;MACAC,EAAA;MACAJ,IAAA;MACAK,QAAA;QACAC,QAAA;QAAA;QACAC,QAAA;QACAC,QAAA;QACAC,WAAA;QACAC,WAAA;MACA;MACAC,KAAA;QACAJ,QAAA;UAAAL,QAAA;UAAAU,OAAA;UAAAC,OAAA;QAAA;QACAL,QAAA;UAAAN,QAAA;UAAAU,OAAA;UAAAC,OAAA;QAAA;QACAJ,WAAA;UAAAP,QAAA;UAAAU,OAAA;UAAAC,OAAA;QAAA;MACA;MACAC,WAAA;QACAC,eAAA;MACA;IACA;EACA;EACAC,QAAA;EACAC,OAAA;IACA;IACAC,KAAAd,EAAA,EAAAJ,IAAA;MACA,KAAAI,EAAA,GAAAA,EAAA;MACA,KAAAJ,IAAA,GAAAA,IAAA;;MAEA;MACA,KAAAK,QAAA,CAAAC,QAAA,QAAAa,QAAA,CAAAC,GAAA;MAEA,IAAAhB,EAAA;QACA,KAAAiB,KAAA;UACAC,GAAA,mBAAAlB,EAAA;UACAmB,MAAA;UACAC,MAAA;QACA,GAAAC,IAAA;UAAAtB;QAAA;UACA,IAAAA,IAAA,IAAAA,IAAA,CAAAuB,IAAA;YACA,KAAArB,QAAA,GAAAF,IAAA,CAAAA,IAAA;UACA;QACA;MACA;IACA;IACA;IACAwB,eAAA;MACA,SAAAtB,QAAA,CAAAG,QAAA;QACA,MAAAoB,SAAA,QAAAvB,QAAA,CAAAG,QAAA;QACA;QACA,OAAAqB,SAAA,EAAAC,WAAA,IAAAF,SAAA,CAAAG,KAAA,MAAAC,GAAA,CAAAC,MAAA;;QAEA;QACA,IAAAC,OAAA,GAAAL,SAAA;QACA,IAAAM,SAAA,GAAAL,WAAA;;QAEA;QACA,MAAAM,OAAA,MAAAF,OAAA,CAAAG,QAAA,GAAAC,QAAA,YAAAH,SAAA,CAAAE,QAAA,GAAAC,QAAA;;QAEA;QACA,KAAAjC,QAAA,CAAAG,QAAA,MAAAoB,SAAA,IAAAQ,OAAA;MACA;IACA;IACA;IACAG,SAAA;MACA,KAAAC,KAAA,aAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,KAAArB,KAAA;YACAC,GAAA,oBAAAjB,QAAA,CAAAD,EAAA;YACAmB,MAAA;YACApB,IAAA,OAAAE;UACA,GAAAoB,IAAA;YAAAtB;UAAA;YACA,IAAAA,IAAA,IAAAA,IAAA,CAAAuB,IAAA;cACA,KAAAiB,QAAA;gBACA/B,OAAA;gBACAZ,IAAA;gBACA4C,QAAA;gBACAC,OAAA,EAAAA,CAAA;kBACA,KAAAC,KAAA;kBACA,KAAAC,IAAA;gBACA;cACA;YACA;cACA,KAAAJ,QAAA,CAAAK,KAAA,CAAA7C,IAAA,CAAA8C,GAAA;YACA;UACA;QACA;MACA;IACA;IACA;IACAF,KAAA;MACA,SAAAhD,MAAA;QACA,KAAAA,MAAA,CAAAmD,QAAA;QACA,KAAAnD,MAAA,CAAAoD,eAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}