{"remainingRequest":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\examrecord\\list.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\examrecord\\list.vue","mtime":1743111777057},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHNob3dGbGFnOiB0cnVlLA0KICAgICAgc2VhcmNoRm9ybTogew0KICAgICAgICB1c2VybmFtZTogJycsDQogICAgICAgIHBhcGVybmFtZTogJycNCiAgICAgIH0sDQogICAgICBkYXRhTGlzdDogW10sDQogICAgICBwYWdlSW5kZXg6IDEsDQogICAgICBwYWdlU2l6ZTogMTAsDQogICAgICB0b3RhbFBhZ2U6IDAsDQogICAgICBkYXRhTGlzdExvYWRpbmc6IGZhbHNlLA0KICAgICAgZGV0YWlsc0RpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgY3VycmVudFJlY29yZDogbnVsbA0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldERhdGFMaXN0KCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOiOt+WPluaVsOaNruWIl+ihqA0KICAgIGdldERhdGFMaXN0KCkgew0KICAgICAgdGhpcy5kYXRhTGlzdExvYWRpbmcgPSB0cnVlDQogICAgICBsZXQgcGFyYW1zID0gew0KICAgICAgICBwYWdlOiB0aGlzLnBhZ2VJbmRleCwNCiAgICAgICAgbGltaXQ6IHRoaXMucGFnZVNpemUsDQogICAgICAgIHNvcnQ6ICdpZCcsDQogICAgICAgIGRvY3RvcklkOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykgLy8g6I635Y+W5b2T5YmN55m75b2V5Yy755Sf55qESUQNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLnNlYXJjaEZvcm0udXNlcm5hbWUpIHsNCiAgICAgICAgcGFyYW1zWyd1c2VybmFtZSddID0gJyUnICsgdGhpcy5zZWFyY2hGb3JtLnVzZXJuYW1lICsgJyUnDQogICAgICB9DQogICAgICBpZiAodGhpcy5zZWFyY2hGb3JtLnBhcGVybmFtZSkgew0KICAgICAgICBwYXJhbXNbJ3BhcGVybmFtZSddID0gJyUnICsgdGhpcy5zZWFyY2hGb3JtLnBhcGVybmFtZSArICclJw0KICAgICAgfQ0KICAgICAgdGhpcy4kaHR0cCh7DQogICAgICAgIHVybDogJy9leGFtcmVjb3JkL2RvY3Rvci9saXN0JywgLy8g6ZyA6KaB5ZCO56uv5o+Q5L6b5q2k5o6l5Y+jDQogICAgICAgIG1ldGhvZDogJ2dldCcsDQogICAgICAgIHBhcmFtczogcGFyYW1zDQogICAgICB9KS50aGVuKCh7IGRhdGEgfSkgPT4gew0KICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmNvZGUgPT09IDApIHsNCiAgICAgICAgICB0aGlzLmRhdGFMaXN0ID0gZGF0YS5kYXRhLmxpc3QNCiAgICAgICAgICB0aGlzLnRvdGFsUGFnZSA9IGRhdGEuZGF0YS50b3RhbA0KICAgICAgICB9DQogICAgICAgIHRoaXMuZGF0YUxpc3RMb2FkaW5nID0gZmFsc2UNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmr4/pobXmlbANCiAgICBzaXplQ2hhbmdlSGFuZGxlKHZhbCkgew0KICAgICAgdGhpcy5wYWdlU2l6ZSA9IHZhbA0KICAgICAgdGhpcy5wYWdlSW5kZXggPSAxDQogICAgICB0aGlzLmdldERhdGFMaXN0KCkNCiAgICB9LA0KICAgIC8vIOW9k+WJjemhtQ0KICAgIGN1cnJlbnRDaGFuZ2VIYW5kbGUodmFsKSB7DQogICAgICB0aGlzLnBhZ2VJbmRleCA9IHZhbA0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpDQogICAgfSwNCiAgICAvLyDmkJzntKINCiAgICBzZWFyY2goKSB7DQogICAgICB0aGlzLnBhZ2VJbmRleCA9IDENCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKQ0KICAgIH0sDQogICAgLy8g5p+l55yL6K+m5oOFDQogICAgdmlld0RldGFpbHMocm93KSB7DQogICAgICB0aGlzLmN1cnJlbnRSZWNvcmQgPSByb3cNCiAgICAgIHRoaXMuZGV0YWlsc0RpYWxvZ1Zpc2libGUgPSB0cnVlDQogICAgfSwNCiAgICAvLyDkuIvovb3nrZTpopjor6bmg4UNCiAgICBkb3dubG9hZERldGFpbHMocm93KSB7DQogICAgICAvLyDliJvlu7rkuIvovb3lhoXlrrkNCiAgICAgIGxldCBjb250ZW50ID0gYOaCo+iAheetlOmimOivpuaDheaKpeWRilxuXG5gDQogICAgICBjb250ZW50ICs9IGDln7rmnKzkv6Hmga/vvJpcbmANCiAgICAgIGNvbnRlbnQgKz0gYOaCo+iAheWnk+WQje+8miR7cm93LnVzZXJuYW1lfVxuYA0KICAgICAgY29udGVudCArPSBg5rWL6K+V5qih5p2/77yaJHtyb3cucGFwZXJuYW1lfVxuYA0KICAgICAgY29udGVudCArPSBg6K+V6aKY5ZCN56ew77yaJHtyb3cucXVlc3Rpb25uYW1lfVxuYA0KICAgICAgY29udGVudCArPSBg562U6aKY5pe26Ze077yaJHtyb3cuYWRkdGltZX1cblxuYA0KICAgICAgY29udGVudCArPSBg562U6aKY5oOF5Ya177yaXG5gDQogICAgICBjb250ZW50ICs9IGDpopjnm67liIblgLzvvJoke3Jvdy5zY29yZX1cbmANCiAgICAgIGNvbnRlbnQgKz0gYOWunumZheW+l+WIhu+8miR7cm93Lm15c2NvcmV9XG5gDQogICAgICBjb250ZW50ICs9IGDmraPnoa7nrZTmoYjvvJoke3Jvdy5hbnN3ZXJ9XG5gDQogICAgICBjb250ZW50ICs9IGDogIPnlJ/nrZTmoYjvvJoke3Jvdy5teWFuc3dlcn1cblxuYA0KICAgICAgaWYgKHJvdy5hbmFseXNpcykgew0KICAgICAgICBjb250ZW50ICs9IGDnrZTmoYjop6PmnpDvvJpcbiR7cm93LmFuYWx5c2lzLnJlcGxhY2UoLzxbXj5dKz4vZywgJycpfVxuYA0KICAgICAgfQ0KDQogICAgICAvLyDliJvlu7rlubbkuIvovb3mlofku7YNCiAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbY29udGVudF0sIHsgdHlwZTogJ3RleHQvcGxhaW47Y2hhcnNldD11dGYtOCcgfSkNCiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykNCiAgICAgIGxpbmsuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikNCiAgICAgIGxpbmsuZG93bmxvYWQgPSBgJHtyb3cudXNlcm5hbWV9LeetlOmimOivpuaDhS0ke3Jvdy5hZGR0aW1lfS50eHRgDQogICAgICBsaW5rLmNsaWNrKCkNCiAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwobGluay5ocmVmKQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/examrecord","sourcesContent":["<template>\r\n  <div class=\"main-content\">\r\n    <!-- 列表页 -->\r\n    <div v-if=\"showFlag\">\r\n      <el-form :inline=\"true\" :model=\"searchForm\" class=\"form-content\">\r\n        <el-row :gutter=\"20\" class=\"slt\">\r\n          <el-form-item label=\"患者姓名\">\r\n            <el-input v-model=\"searchForm.username\" placeholder=\"患者姓名\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"测试模板\">\r\n            <el-input v-model=\"searchForm.papername\" placeholder=\"测试模板名称\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"search()\">查询</el-button>\r\n          </el-form-item>\r\n        </el-row>\r\n      </el-form>\r\n\r\n      <div class=\"table-content\">\r\n        <el-table :data=\"dataList\" border v-loading=\"dataListLoading\" style=\"width: 100%\">\r\n          <el-table-column prop=\"username\" label=\"患者姓名\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"papername\" label=\"测试模板\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"questionname\" label=\"试题名称\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"score\" label=\"题目分值\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"myscore\" label=\"实际得分\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"addtime\" label=\"答题时间\" align=\"center\"></el-table-column>\r\n          <el-table-column label=\"操作\" width=\"200\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"text\" size=\"small\" @click=\"viewDetails(scope.row)\">查看详情</el-button>\r\n              <el-button type=\"text\" size=\"small\" @click=\"downloadDetails(scope.row)\">下载答题详情</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        \r\n        <el-pagination\r\n          @size-change=\"sizeChangeHandle\"\r\n          @current-change=\"currentChangeHandle\"\r\n          :current-page=\"pageIndex\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pageSize\"\r\n          :total=\"totalPage\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n        ></el-pagination>\r\n      </div>\r\n\r\n      <!-- 查看详情对话框 -->\r\n      <el-dialog title=\"答题详情\" :visible.sync=\"detailsDialogVisible\" width=\"60%\">\r\n        <div v-if=\"currentRecord\">\r\n          <h3>基本信息</h3>\r\n          <el-descriptions :column=\"2\" border>\r\n            <el-descriptions-item label=\"患者姓名\">{{ currentRecord.username }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"测试模板\">{{ currentRecord.papername }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"试题名称\">{{ currentRecord.questionname }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"答题时间\">{{ currentRecord.addtime }}</el-descriptions-item>\r\n          </el-descriptions>\r\n          \r\n          <h3 style=\"margin-top: 20px\">答题情况</h3>\r\n          <el-descriptions :column=\"2\" border>\r\n            <el-descriptions-item label=\"题目分值\">{{ currentRecord.score }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"实际得分\">{{ currentRecord.myscore }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"正确答案\">{{ currentRecord.answer }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"考生答案\">{{ currentRecord.myanswer }}</el-descriptions-item>\r\n          </el-descriptions>\r\n\r\n          <div v-if=\"currentRecord.analysis\" style=\"margin-top: 20px\">\r\n            <h3>答案解析</h3>\r\n            <div v-html=\"currentRecord.analysis\"></div>\r\n          </div>\r\n        </div>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      showFlag: true,\r\n      searchForm: {\r\n        username: '',\r\n        papername: ''\r\n      },\r\n      dataList: [],\r\n      pageIndex: 1,\r\n      pageSize: 10,\r\n      totalPage: 0,\r\n      dataListLoading: false,\r\n      detailsDialogVisible: false,\r\n      currentRecord: null\r\n    }\r\n  },\r\n  created() {\r\n    this.getDataList()\r\n  },\r\n  methods: {\r\n    // 获取数据列表\r\n    getDataList() {\r\n      this.dataListLoading = true\r\n      let params = {\r\n        page: this.pageIndex,\r\n        limit: this.pageSize,\r\n        sort: 'id',\r\n        doctorId: localStorage.getItem('userId') // 获取当前登录医生的ID\r\n      }\r\n      if (this.searchForm.username) {\r\n        params['username'] = '%' + this.searchForm.username + '%'\r\n      }\r\n      if (this.searchForm.papername) {\r\n        params['papername'] = '%' + this.searchForm.papername + '%'\r\n      }\r\n      this.$http({\r\n        url: '/examrecord/doctor/list', // 需要后端提供此接口\r\n        method: 'get',\r\n        params: params\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          this.dataList = data.data.list\r\n          this.totalPage = data.data.total\r\n        }\r\n        this.dataListLoading = false\r\n      })\r\n    },\r\n    // 每页数\r\n    sizeChangeHandle(val) {\r\n      this.pageSize = val\r\n      this.pageIndex = 1\r\n      this.getDataList()\r\n    },\r\n    // 当前页\r\n    currentChangeHandle(val) {\r\n      this.pageIndex = val\r\n      this.getDataList()\r\n    },\r\n    // 搜索\r\n    search() {\r\n      this.pageIndex = 1\r\n      this.getDataList()\r\n    },\r\n    // 查看详情\r\n    viewDetails(row) {\r\n      this.currentRecord = row\r\n      this.detailsDialogVisible = true\r\n    },\r\n    // 下载答题详情\r\n    downloadDetails(row) {\r\n      // 创建下载内容\r\n      let content = `患者答题详情报告\\n\\n`\r\n      content += `基本信息：\\n`\r\n      content += `患者姓名：${row.username}\\n`\r\n      content += `测试模板：${row.papername}\\n`\r\n      content += `试题名称：${row.questionname}\\n`\r\n      content += `答题时间：${row.addtime}\\n\\n`\r\n      content += `答题情况：\\n`\r\n      content += `题目分值：${row.score}\\n`\r\n      content += `实际得分：${row.myscore}\\n`\r\n      content += `正确答案：${row.answer}\\n`\r\n      content += `考生答案：${row.myanswer}\\n\\n`\r\n      if (row.analysis) {\r\n        content += `答案解析：\\n${row.analysis.replace(/<[^>]+>/g, '')}\\n`\r\n      }\r\n\r\n      // 创建并下载文件\r\n      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' })\r\n      const link = document.createElement('a')\r\n      link.href = URL.createObjectURL(blob)\r\n      link.download = `${row.username}-答题详情-${row.addtime}.txt`\r\n      link.click()\r\n      URL.revokeObjectURL(link.href)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.form-content {\r\n  padding: 20px;\r\n  background-color: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n.slt {\r\n  margin: 0;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.table-content {\r\n  margin-top: 20px;\r\n}\r\n.el-pagination {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n</style>\r\n"]}]}