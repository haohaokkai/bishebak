{"remainingRequest":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\examrecord\\list.vue?vue&type=style&index=0&id=4bf983eb&scoped=true&lang=css","dependencies":[{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\src\\views\\modules\\examrecord\\list.vue","mtime":1743111777057},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Myproject\\BISHE\\pro2.0\\project\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZm9ybS1jb250ZW50IHsNCiAgcGFkZGluZzogMjBweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjdmYTsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KLnNsdCB7DQogIG1hcmdpbjogMDsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCi50YWJsZS1jb250ZW50IHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCn0NCi5lbC1wYWdpbmF0aW9uIHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAgdGV4dC1hbGlnbjogcmlnaHQ7DQp9DQo="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";AA+KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/modules/examrecord","sourcesContent":["<template>\r\n  <div class=\"main-content\">\r\n    <!-- 列表页 -->\r\n    <div v-if=\"showFlag\">\r\n      <el-form :inline=\"true\" :model=\"searchForm\" class=\"form-content\">\r\n        <el-row :gutter=\"20\" class=\"slt\">\r\n          <el-form-item label=\"患者姓名\">\r\n            <el-input v-model=\"searchForm.username\" placeholder=\"患者姓名\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"测试模板\">\r\n            <el-input v-model=\"searchForm.papername\" placeholder=\"测试模板名称\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"search()\">查询</el-button>\r\n          </el-form-item>\r\n        </el-row>\r\n      </el-form>\r\n\r\n      <div class=\"table-content\">\r\n        <el-table :data=\"dataList\" border v-loading=\"dataListLoading\" style=\"width: 100%\">\r\n          <el-table-column prop=\"username\" label=\"患者姓名\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"papername\" label=\"测试模板\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"questionname\" label=\"试题名称\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"score\" label=\"题目分值\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"myscore\" label=\"实际得分\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"addtime\" label=\"答题时间\" align=\"center\"></el-table-column>\r\n          <el-table-column label=\"操作\" width=\"200\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"text\" size=\"small\" @click=\"viewDetails(scope.row)\">查看详情</el-button>\r\n              <el-button type=\"text\" size=\"small\" @click=\"downloadDetails(scope.row)\">下载答题详情</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        \r\n        <el-pagination\r\n          @size-change=\"sizeChangeHandle\"\r\n          @current-change=\"currentChangeHandle\"\r\n          :current-page=\"pageIndex\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pageSize\"\r\n          :total=\"totalPage\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n        ></el-pagination>\r\n      </div>\r\n\r\n      <!-- 查看详情对话框 -->\r\n      <el-dialog title=\"答题详情\" :visible.sync=\"detailsDialogVisible\" width=\"60%\">\r\n        <div v-if=\"currentRecord\">\r\n          <h3>基本信息</h3>\r\n          <el-descriptions :column=\"2\" border>\r\n            <el-descriptions-item label=\"患者姓名\">{{ currentRecord.username }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"测试模板\">{{ currentRecord.papername }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"试题名称\">{{ currentRecord.questionname }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"答题时间\">{{ currentRecord.addtime }}</el-descriptions-item>\r\n          </el-descriptions>\r\n          \r\n          <h3 style=\"margin-top: 20px\">答题情况</h3>\r\n          <el-descriptions :column=\"2\" border>\r\n            <el-descriptions-item label=\"题目分值\">{{ currentRecord.score }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"实际得分\">{{ currentRecord.myscore }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"正确答案\">{{ currentRecord.answer }}</el-descriptions-item>\r\n            <el-descriptions-item label=\"考生答案\">{{ currentRecord.myanswer }}</el-descriptions-item>\r\n          </el-descriptions>\r\n\r\n          <div v-if=\"currentRecord.analysis\" style=\"margin-top: 20px\">\r\n            <h3>答案解析</h3>\r\n            <div v-html=\"currentRecord.analysis\"></div>\r\n          </div>\r\n        </div>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      showFlag: true,\r\n      searchForm: {\r\n        username: '',\r\n        papername: ''\r\n      },\r\n      dataList: [],\r\n      pageIndex: 1,\r\n      pageSize: 10,\r\n      totalPage: 0,\r\n      dataListLoading: false,\r\n      detailsDialogVisible: false,\r\n      currentRecord: null\r\n    }\r\n  },\r\n  created() {\r\n    this.getDataList()\r\n  },\r\n  methods: {\r\n    // 获取数据列表\r\n    getDataList() {\r\n      this.dataListLoading = true\r\n      let params = {\r\n        page: this.pageIndex,\r\n        limit: this.pageSize,\r\n        sort: 'id',\r\n        doctorId: localStorage.getItem('userId') // 获取当前登录医生的ID\r\n      }\r\n      if (this.searchForm.username) {\r\n        params['username'] = '%' + this.searchForm.username + '%'\r\n      }\r\n      if (this.searchForm.papername) {\r\n        params['papername'] = '%' + this.searchForm.papername + '%'\r\n      }\r\n      this.$http({\r\n        url: '/examrecord/doctor/list', // 需要后端提供此接口\r\n        method: 'get',\r\n        params: params\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          this.dataList = data.data.list\r\n          this.totalPage = data.data.total\r\n        }\r\n        this.dataListLoading = false\r\n      })\r\n    },\r\n    // 每页数\r\n    sizeChangeHandle(val) {\r\n      this.pageSize = val\r\n      this.pageIndex = 1\r\n      this.getDataList()\r\n    },\r\n    // 当前页\r\n    currentChangeHandle(val) {\r\n      this.pageIndex = val\r\n      this.getDataList()\r\n    },\r\n    // 搜索\r\n    search() {\r\n      this.pageIndex = 1\r\n      this.getDataList()\r\n    },\r\n    // 查看详情\r\n    viewDetails(row) {\r\n      this.currentRecord = row\r\n      this.detailsDialogVisible = true\r\n    },\r\n    // 下载答题详情\r\n    downloadDetails(row) {\r\n      // 创建下载内容\r\n      let content = `患者答题详情报告\\n\\n`\r\n      content += `基本信息：\\n`\r\n      content += `患者姓名：${row.username}\\n`\r\n      content += `测试模板：${row.papername}\\n`\r\n      content += `试题名称：${row.questionname}\\n`\r\n      content += `答题时间：${row.addtime}\\n\\n`\r\n      content += `答题情况：\\n`\r\n      content += `题目分值：${row.score}\\n`\r\n      content += `实际得分：${row.myscore}\\n`\r\n      content += `正确答案：${row.answer}\\n`\r\n      content += `考生答案：${row.myanswer}\\n\\n`\r\n      if (row.analysis) {\r\n        content += `答案解析：\\n${row.analysis.replace(/<[^>]+>/g, '')}\\n`\r\n      }\r\n\r\n      // 创建并下载文件\r\n      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' })\r\n      const link = document.createElement('a')\r\n      link.href = URL.createObjectURL(blob)\r\n      link.download = `${row.username}-答题详情-${row.addtime}.txt`\r\n      link.click()\r\n      URL.revokeObjectURL(link.href)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.form-content {\r\n  padding: 20px;\r\n  background-color: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n.slt {\r\n  margin: 0;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.table-content {\r\n  margin-top: 20px;\r\n}\r\n.el-pagination {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n</style>\r\n"]}]}